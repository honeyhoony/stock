<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>퀀트 트레이딩 대시보드 — 5대 전략 스캐너</title>
  <meta name="description" content="눌림목, 바닥탈출, 골든크로스, 박스권돌파, 정배열초입 5대 전략 기반 실시간 퀀트 트레이딩 스캐너" />
  <link rel="stylesheet" href="/static/style.css" />
</head>

<body>

  <!-- Scanning Overlay -->
  <div class="scanning-overlay" id="scanningOverlay">
    <div class="scanning-pulse">🔍</div>
    <div class="scanning-text" id="scanningText">전략 스캔 중...</div>
    <div class="scanning-sub" id="scanningSub">잠시만 기다려주세요</div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <div class="app-container">

    <!-- ═══════ Header ═══════ -->
    <header class="header" id="appHeader">
      <div class="header-brand">
        <div class="header-logo">📊</div>
        <div>
          <div class="header-title">퀀트 트레이딩 스캐너</div>
          <div class="header-subtitle">5대 전략 · 수급 가속도 기반 · 감정 배제</div>
        </div>
      </div>
      <div class="header-actions">
        <div class="header-time" id="headerTime">--:--:--</div>
        <button class="btn btn-outline btn-sm" id="btnMarket" onclick="loadMarketCondition()">
          📈 시장 상태
        </button>
        <button class="btn btn-primary" id="btnScan" onclick="runScan()">
          🚀 스캔 실행
        </button>
      </div>
    </header>

    <!-- ═══════ Market Status ═══════ -->
    <section class="market-bar" id="marketBar">
      <div class="market-card neutral" id="marketKospi">
        <div class="market-card-header">
          <span class="market-card-title">코스피</span>
          <span class="market-card-badge badge-neutral" id="kospiBadge">—</span>
        </div>
        <div class="market-card-value" id="kospiValue">—</div>
        <div class="market-card-desc" id="kospiDesc">시장 분석 대기 중</div>
      </div>
      <div class="market-card neutral" id="marketKosdaq">
        <div class="market-card-header">
          <span class="market-card-title">코스닥</span>
          <span class="market-card-badge badge-neutral" id="kosdaqBadge">—</span>
        </div>
        <div class="market-card-value" id="kosdaqValue">—</div>
        <div class="market-card-desc" id="kosdaqDesc">시장 분석 대기 중</div>
      </div>
      <div class="market-card neutral" id="marketPhase">
        <div class="market-card-header">
          <span class="market-card-title">시장 국면</span>
          <span class="market-card-badge badge-neutral" id="phaseBadge">NEUTRAL</span>
        </div>
        <div class="market-card-value" id="phaseValue">—</div>
        <div class="market-card-desc" id="phaseDesc">최대 투자비중: —</div>
      </div>
      <div class="market-card neutral" id="marketStrategy">
        <div class="market-card-header">
          <span class="market-card-title">허용 전략</span>
          <span class="market-card-badge badge-neutral" id="strategyBadge">—</span>
        </div>
        <div class="market-card-value" id="strategyValue">—</div>
        <div class="market-card-desc" id="strategyDesc">전략 제한 없음</div>
      </div>
    </section>

    <!-- ═══════ Controls ═══════ -->
    <section class="controls-section">
      <div class="search-box">
        <span class="search-icon">🔎</span>
        <input type="text" id="searchInput" placeholder="종목명 또는 종목코드로 검색..." oninput="filterSignals()" />
      </div>
      <div class="filter-pills" id="filterPills">
        <button class="filter-pill active" data-filter="all" onclick="setFilter('all', this)">전체</button>
        <button class="filter-pill" data-filter="눌림목" onclick="setFilter('눌림목', this)">🔵 눌림목</button>
        <button class="filter-pill" data-filter="바닥탈출" onclick="setFilter('바닥탈출', this)">🟢 바닥탈출</button>
        <button class="filter-pill" data-filter="골든크로스" onclick="setFilter('골든크로스', this)">🟡 골든크로스</button>
        <button class="filter-pill" data-filter="박스권돌파" onclick="setFilter('박스권돌파', this)">🔴 박스권돌파</button>
        <button class="filter-pill" data-filter="정배열초입" onclick="setFilter('정배열초입', this)">🟣 정배열초입</button>
        <button class="filter-pill" data-filter="approved" onclick="setFilter('approved', this)">✅ 매수승인만</button>
      </div>
    </section>

    <!-- ═══════ Summary Stats ═══════ -->
    <section class="summary-bar" id="summaryBar" style="display:none;">
      <div class="summary-stat">
        <div class="summary-stat-value" id="statTotal">0</div>
        <div class="summary-stat-label">감지 신호</div>
      </div>
      <div class="summary-stat">
        <div class="summary-stat-value" id="statApproved" style="color: var(--green-600);">0</div>
        <div class="summary-stat-label">매수 승인</div>
      </div>
      <div class="summary-stat">
        <div class="summary-stat-value" id="statWatch" style="color: var(--amber-600);">0</div>
        <div class="summary-stat-label">관망</div>
      </div>
      <div class="summary-stat">
        <div class="summary-stat-value" id="statScanned">0</div>
        <div class="summary-stat-label">스캔 종목</div>
      </div>
      <div class="summary-stat">
        <div class="summary-stat-value" id="statTime">0s</div>
        <div class="summary-stat-label">소요 시간</div>
      </div>
    </section>

    <!-- ═══════ Signals Grid ═══════ -->
    <section class="signals-grid" id="signalsGrid">
      <div class="empty-state" id="emptyState">
        <div class="empty-state-icon">🎯</div>
        <h3>스캔 대기 중</h3>
        <p>상단의 <strong>"🚀 스캔 실행"</strong> 버튼을 클릭하면 시장을 분석하고 매수 기회를 탐색합니다.</p>
        <button class="btn btn-primary btn-lg" onclick="runScan()">🚀 스캔 시작하기</button>
      </div>
    </section>

    <!-- ═══════ 관찰 리스트 (Watchlist) ═══════ -->
    <section class="watchlist-section" id="watchlistSection">
      <div class="watchlist-header">
        <div>
          <h2 class="watchlist-title">📌 관찰 리스트</h2>
          <p class="watchlist-subtitle">보유 종목 실시간 손절 감시 · 1분 간격 자동 체크</p>
        </div>
        <div class="watchlist-controls">
          <span class="monitor-status" id="monitorStatus">🔴 중지됨</span>
          <button class="btn btn-outline btn-sm" onclick="checkWatchlist()">🔄 수동 체크</button>
          <button class="btn btn-primary btn-sm" onclick="startMonitoring()">▶️ 모니터링</button>
          <button class="btn btn-outline btn-sm" onclick="stopMonitoring()">⏹️ 정지</button>
        </div>
      </div>

      <!-- 종목 등록 폼 -->
      <div class="watchlist-add-form">
        <input type="text" id="wlTicker" placeholder="종목코드 (예: 005930)" class="wl-input" />
        <input type="text" id="wlName" placeholder="종목명 (선택)" class="wl-input" />
        <input type="number" id="wlBuyPrice" placeholder="매수가" class="wl-input" />
        <input type="number" id="wlQuantity" placeholder="수량 (선택)" class="wl-input wl-input-sm" />
        <button class="btn btn-primary btn-sm" onclick="addWatchlistItem()">➕ 등록</button>
      </div>

      <!-- 관찰 테이블 -->
      <div class="watchlist-table-wrap">
        <table class="watchlist-table">
          <thead>
            <tr>
              <th>종목</th>
              <th>매수가</th>
              <th>현재가</th>
              <th>손익률</th>
              <th>손절가</th>
              <th>상태</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="watchlistBody">
            <tr>
              <td colspan="7" style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                종목을 등록하거나 텔레그램으로 <code>삼성전자 / 78500</code> 형식으로 입력하세요.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

  </div>

  <script src="/static/app.js"></script>
</body>

</html>